# 选择器优先级

> **参考**
>
> [《层叠与继承》【来源：MDN】](https://developer.mozilla.org/zh-CN/docs/Learn/CSS/Building_blocks/Cascade_and_inheritance)
>
> [《优先级》【来源：MDN】](https://developer.mozilla.org/zh-CN/docs/Web/CSS/Specificity)

[TOC]

## 层叠

Stylesheets cascade（样式表层叠） — 简单的说，**css 规则的顺序很重要；当应用两条同级别的规则到一个元素的时候，写在后面的就是实际使用的规则。**

## 优先级

浏览器是根据优先级来决定当多个规则有不同选择器对应相同的元素的时候需要使用哪个规则。它基本上是一个衡量选择器具体选择哪些区域的尺度：

- 一个元素选择器不是很具体 — 会选择页面上该类型的所有元素 — 所以它的优先级就会低一些。
- 一个类选择器稍微具体点 — 它会选择该页面中有特定 class 属性值的元素 — 所以它的优先级就要高一点。

## 继承

继承也需要在上下文中去理解 —— 一些设置在父元素上的 css 属性是可以被子元素继承的，有些则不能。

## 理解层叠

有三个因素需要考虑，根据重要性排序如下，前面的更重要：

- 重要程度
- 优先级
- 资源顺序

### 资源顺序

如果有超过一条规则，而且都是相同的权重，那么最后面的规则会应用。可以理解为后面的规则覆盖前面的规则，直到最后一个开始设置样式。

### 优先级

在你了解了顺序的重要性后，会发现在一些情况下，有些规则在最后出现，但是却应用了前面的规则。这是因为前面的有更高的优先级 — 它范围更小，因此浏览器就把它选择为元素的样式。

浏览器如何计算优先级？

一个元素选择器比类选择器的优先级更低会被其覆盖。本质上，不同类型的选择器有不同的分数值，把这些分数相加就得到特定选择器的权重，然后就可以进行匹配。

一个选择器的优先级可以说是由四个部分相加 (分量)，可以认为是个十百千 — 四位数的四个位数：

- **千位**： 如果声明在 style 的属性（内联样式）则该位得一分。这样的声明没有选择器，所以它得分总是 1000。
- **百位**： 选择器中包含 ID 选择器则该位得一分。
- **十位**： 选择器中包含类选择器、属性选择器或者伪类则该位得一分。
- **个位**：选择器中包含元素、伪元素选择器则该位得一分。

> 注: 通用选择器 (`*`)，组合符 (+, >, ~, ' ')，和否定伪类 (:not) 不会影响优先级。
>
> <i style="color: red;">警告: 在进行计算时不允许进行进位，例如，20 个类选择器仅仅意味着 20 个十位，而不能视为 两个百位，也就是说，无论多少个类选择器的权重叠加，都不会超过一个 ID 选择器。</i>

| 选择器                                  | 千位 | 百位 | 十位 | 个位 | 优先级 |
| --------------------------------------- | :--: | :--: | :--: | :--: | -----: |
| h1                                      |  0   |  0   |  0   |  0   |   0001 |
| h1 + p::first-letter                    |  0   |  0   |  0   |  3   |   0003 |
| li > a[href*="en-US"] > .inline-warning |  0   |  0   |  2   |  2   |   0022 |
| #identifier                             |  0   |  1   |  0   |  0   |   0100 |
| 内联样式                                |  1   |  0   |  0   |  0   |   1000 |

### !important

用于修改特定属性的值， 能够覆盖普通规则的层叠。

> 注：覆盖 !important 唯一的办法就是另一个 !important 具有 相同优先级 而且顺序靠后，或者更高优先级。
